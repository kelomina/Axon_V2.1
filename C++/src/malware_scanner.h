#pragma once

#include "family_classifier.h"
#include "kvd_internal.h"
#include "lightgbm_infer.h"

#include <optional>
#include <string>
#include <vector>

namespace kvd {

class MalwareScanner {
 public:
  static std::optional<MalwareScanner> create(const Config& config);

  ScanResult scan_path(const std::string& path) const;
  ScanResult scan_bytes(const std::vector<std::uint8_t>& bytes) const;

 private:
  Config config_;
  LightGbmModel model_;
  std::optional<LightGbmModel> model_normal_;
  std::optional<LightGbmModel> model_packed_;
  std::optional<FamilyClassifier> family_classifier_;
};

}
